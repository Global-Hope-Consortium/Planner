(()=>{var e={};e.id=917,e.ids=[917],e.modules={9344:e=>{"use strict";e.exports=require("jsonwebtoken")},145:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},496:e=>{"use strict";e.exports=require("sequelize")},5616:e=>{"use strict";e.exports=import("next-connect")},6249:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},6768:(e,t,s)=>{"use strict";s.a(e,async(e,n)=>{try{s.r(t),s.d(t,{config:()=>c,default:()=>u,routeModule:()=>d});var r=s(1802),a=s(7153),o=s(6249),i=s(243),l=e([i]);i=(l.then?(await l)():l)[0];let u=(0,o.l)(i,"default"),c=(0,o.l)(i,"config"),d=new r.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/analysis/budget",pathname:"/api/analysis/budget",bundlePath:"",filename:""},userland:i});n()}catch(e){n(e)}})},2884:(e,t,s)=>{"use strict";let{Sequelize:n}=s(496),r=new n(process.env.DATABASE_URL,{dialect:"postgres",logging:!1}),a=async()=>{try{await r.authenticate(),console.log("Database connected successfully.")}catch(e){console.error("Unable to connect to the database:",e)}},o=async()=>{try{await r.sync({alter:!0}),console.log("All models were synchronized successfully.")}catch(e){console.error("Error synchronizing models:",e)}};e.exports={sequelize:r,testDBConnection:a,syncModels:o}},926:()=>{},6721:(e,t,s)=>{"use strict";s.d(t,{W:()=>o});var n=s(9344),r=s.n(n),a=s(926);let o=(e,t,s)=>{let n=e.headers.authorization?.split(" ")[1];if(!n)return t.status(401).json({message:"No token provided."});r().verify(n,a.jwtSecret,(n,r)=>{if(n)return t.status(401).json({message:"Unauthorized."});e.user=r,s()})}},7266:(e,t,s)=>{"use strict";let{DataTypes:n}=s(496),{sequelize:r}=s(2884),a=r.define("Plan",{userId:{type:n.INTEGER,allowNull:!1},title:{type:n.STRING,allowNull:!1},amount:{type:n.DECIMAL,allowNull:!1},description:{type:n.TEXT}});e.exports=a},243:(e,t,s)=>{"use strict";s.a(e,async(e,n)=>{try{s.r(t),s.d(t,{default:()=>d});var r=s(5616),a=s(7266),o=s.n(a),i=s(2884),l=s(6721),u=e([r]);r=(u.then?(await u)():u)[0];let c=(0,r.default)();c.use(l.W).get(async(e,t)=>{await (0,i.connectDB)();let s=e.user.id,n=await o().findAll({where:{userId:s}}),r=n.reduce((e,t)=>e+parseFloat(t.amount),0);t.status(200).json({totalAmount:r,numberOfPlans:n.length,averageAmount:n.length?r/n.length:0})});let d=c;n()}catch(e){n(e)}})},7153:(e,t)=>{"use strict";var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},1802:(e,t,s)=>{"use strict";e.exports=s(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var s=t(t.s=6768);module.exports=s})();