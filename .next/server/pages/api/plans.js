(()=>{var e={};e.id=583,e.ids=[583],e.modules={9344:e=>{"use strict";e.exports=require("jsonwebtoken")},145:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},496:e=>{"use strict";e.exports=require("sequelize")},5616:e=>{"use strict";e.exports=import("next-connect")},6249:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},9314:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{config:()=>l,default:()=>c,routeModule:()=>d});var n=s(1802),a=s(7153),o=s(6249),i=s(4105),u=e([i]);i=(u.then?(await u)():u)[0];let c=(0,o.l)(i,"default"),l=(0,o.l)(i,"config"),d=new n.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/plans",pathname:"/api/plans",bundlePath:"",filename:""},userland:i});r()}catch(e){r(e)}})},2884:(e,t,s)=>{"use strict";let{Sequelize:r}=s(496),n=new r(process.env.DATABASE_URL,{dialect:"postgres",logging:!1}),a=async()=>{try{await n.authenticate(),console.log("Database connected successfully.")}catch(e){console.error("Unable to connect to the database:",e)}},o=async()=>{try{await n.sync({alter:!0}),console.log("All models were synchronized successfully.")}catch(e){console.error("Error synchronizing models:",e)}};e.exports={sequelize:n,testDBConnection:a,syncModels:o}},926:()=>{},6721:(e,t,s)=>{"use strict";s.d(t,{W:()=>o});var r=s(9344),n=s.n(r),a=s(926);let o=(e,t,s)=>{let r=e.headers.authorization?.split(" ")[1];if(!r)return t.status(401).json({message:"No token provided."});n().verify(r,a.jwtSecret,(r,n)=>{if(r)return t.status(401).json({message:"Unauthorized."});e.user=n,s()})}},7266:(e,t,s)=>{"use strict";let{DataTypes:r}=s(496),{sequelize:n}=s(2884),a=n.define("Plan",{userId:{type:r.INTEGER,allowNull:!1},title:{type:r.STRING,allowNull:!1},amount:{type:r.DECIMAL,allowNull:!1},description:{type:r.TEXT}});e.exports=a},4105:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>d});var n=s(5616),a=s(7266),o=s.n(a),i=s(2884),u=s(6721),c=e([n]);n=(c.then?(await c)():c)[0];let l=(0,n.default)();l.use(u.W).post(async(e,t)=>{await (0,i.connectDB)();let{title:s,amount:r,description:n}=e.body,a=e.user.id,u=await o().create({userId:a,title:s,amount:r,description:n});t.status(201).json(u)}),l.use(u.W).get(async(e,t)=>{await (0,i.connectDB)();let s=e.user.id,r=await o().findAll({where:{userId:s}});t.status(200).json(r)});let d=l;r()}catch(e){r(e)}})},7153:(e,t)=>{"use strict";var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},1802:(e,t,s)=>{"use strict";e.exports=s(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var s=t(t.s=9314);module.exports=s})();