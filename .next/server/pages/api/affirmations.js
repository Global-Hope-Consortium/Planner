(()=>{var e={};e.id=968,e.ids=[968],e.modules={9344:e=>{"use strict";e.exports=require("jsonwebtoken")},145:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},496:e=>{"use strict";e.exports=require("sequelize")},5616:e=>{"use strict";e.exports=import("next-connect")},6249:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},1283:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{config:()=>l,default:()=>u,routeModule:()=>d});var n=s(1802),a=s(7153),i=s(6249),o=s(7390),c=e([o]);o=(c.then?(await c)():c)[0];let u=(0,i.l)(o,"default"),l=(0,i.l)(o,"config"),d=new n.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/affirmations",pathname:"/api/affirmations",bundlePath:"",filename:""},userland:o});r()}catch(e){r(e)}})},2884:(e,t,s)=>{"use strict";let{Sequelize:r}=s(496),n=new r(process.env.DATABASE_URL,{dialect:"postgres",logging:!1}),a=async()=>{try{await n.authenticate(),console.log("Database connected successfully.")}catch(e){console.error("Unable to connect to the database:",e)}},i=async()=>{try{await n.sync({alter:!0}),console.log("All models were synchronized successfully.")}catch(e){console.error("Error synchronizing models:",e)}};e.exports={sequelize:n,testDBConnection:a,syncModels:i}},926:()=>{},6721:(e,t,s)=>{"use strict";s.d(t,{W:()=>i});var r=s(9344),n=s.n(r),a=s(926);let i=(e,t,s)=>{let r=e.headers.authorization?.split(" ")[1];if(!r)return t.status(401).json({message:"No token provided."});n().verify(r,a.jwtSecret,(r,n)=>{if(r)return t.status(401).json({message:"Unauthorized."});e.user=n,s()})}},6155:(e,t,s)=>{"use strict";let{DataTypes:r}=s(496),{sequelize:n}=s(2884),a=n.define("Affirmation",{userId:{type:r.INTEGER,allowNull:!1},content:{type:r.TEXT,allowNull:!1}});e.exports=a},7390:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>d});var n=s(5616),a=s(6155),i=s.n(a),o=s(2884),c=s(6721),u=e([n]);n=(u.then?(await u)():u)[0];let l=(0,n.default)();l.use(c.W).post(async(e,t)=>{await (0,o.connectDB)();let{content:s}=e.body,r=e.user.id,n=await i().create({userId:r,content:s});t.status(201).json(n)}),l.use(c.W).get(async(e,t)=>{await (0,o.connectDB)();let s=e.user.id,r=await i().findAll({where:{userId:s}});t.status(200).json(r)});let d=l;r()}catch(e){r(e)}})},7153:(e,t)=>{"use strict";var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},1802:(e,t,s)=>{"use strict";e.exports=s(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var s=t(t.s=1283);module.exports=s})();